root: true

globals:
  React: writable

parser: "@babel/eslint-parser"

extends:
  - eslint:recommended

plugins:
  - "@babel"
  - "html"

parserOptions:
  allowImportExportEverywhere: false
  # babelOptions:
    # configFile: "./.babelrc"
    # Monorepo configuration
    # rootMode: upward
  ecmaVersion: 6
  ecmaFeatures: true
  globalReturn: false
  jsxPragma: React
  legacyDecorators: true
  requireConfigFile: false
  sourceType: "module"

env:
  es6: true
  node: true
  browser: true
  commonjs: true

settings:
  import/resolver:
    webpack:
      config: "webpack.config.babel.js"

rules:
  jsx-quotes:
    - error
    - prefer-double

  # 禁止或强制在括号内使用空格
  array-bracket-spacing:
    - error
    - always
    - singleValue: true
      objectsInArrays: false
      arraysInArrays: false

  # 强制数组方法的回调函数中有 return 语句
  array-callback-return:
    - error
    - allowImplicit: false        # 是否允许隐式使用 return 不包含任何表达式地返回

  arrow-parens:
    - error
    - always

  arrow-body-style:
    - off
    - as-needed
    - requireReturnForObjectLiteral: true

  # 大括号风格要求
  brace-style:
    - warn
    - stroustrup

  camelcase:
    - error
    - ignoreDestructuring: true

  computed-property-spacing:
    - error
    - never

  # 逗号
  comma-spacing:
    - error
    - before: false
      after: true
  # 逗号风格
  comma-style:
    - error
    - last

  dot-location:
    - error
    - property

  # 缩进
  indent:
    - error
    - 2
    - SwitchCase: 1
      ImportDeclaration: 1
      MemberExpression: 0
      VariableDeclarator: "first"

  # 要求或禁止在类成员之间出现空行
  lines-between-class-members:
    - error
    - always
    - exceptAfterSingleLine: false

  multiline-comment-style:
    - error
    - starred-block
  newline-per-chained-call:
    - warn
    - ignoreChainWithDepth: 5
  no-empty:
    - error
    - allowEmptyCatch: true

  no-empty-function: off

  # 禁止 if 语句作为唯一语句出现在 else 语句块中
  no-lonely-if:
    - error

  # 禁止使用 空格 和 tab 混合缩进
  no-mixed-spaces-and-tabs:
    - error

  # 不允许多个空行
  no-multiple-empty-lines:
    - error
    - max: 2
      maxBOF: 0
      maxEOF: 1

  no-new-func: error

  no-param-reassign:
    - error

  no-prototype-builtins: off

  # 禁止在返回语句中赋值
  no-return-assign:
    - error
    - always

  no-sequences:
    - error

  no-spaced-func: error

  no-sparse-arrays: warn

  no-var: error

  no-useless-return:
    - off

  no-useless-concat:
    - error

  no-useless-constructor:
    - warn

  # 禁用不必要的转义
  no-useless-escape:
    - error

  no-unused-vars: warn

  # 禁止属性前有空白
  no-whitespace-before-property:
    - error

  # 强制单个语句的位置
  nonblock-statement-body-position:
    - warn
    - below

  quotes:
    - warn
    - single

  # 禁止使用不带 await 表达式的 async 函数
  require-await:
    - error

  semi: error

  semi-spacing:
    - error
    - before: false
      after: true

  # sort-imports:
  #   - warn
  #   - ignoreMemberSort: false
  #     memberSyntaxSortOrder: ["none", "all", "multiple", "single"]

  space-before-function-paren:
    - error
    - anonymous: never
      named: never
      asyncArrow: always

  # space-in-parens:
  #   - error
  #   - always

  key-spacing:
    - error
    - beforeColon: false
      afterColon: true
      # align: colon

  keyword-spacing:
    - error
    - after: true

  object-curly-spacing:
    - off
    - always
    - arraysInObjects: false
      objectsInObjects: false
      allowSeparatedGroups: false

  # 强制在花括号内使用一致的换行符
  object-curly-newline:
    - error
    - ImportDeclaration:
        multiline: true
      ExportDeclaration:
        multiline: true
        minProperties: 3
        consistent: true
      ObjectExpression:
        multiline: true
        minProperties: 3
        consistent: true
      ObjectPattern:
        multiline: true
        minProperties: 2
        consistent: true
    # - consistent: true

  padded-blocks:
    - error
    - blocks: never
      switches: never
      classes: never
    - allowSingleLineBlocks: false

  padding-line-between-statements:
    - error
    - blankLine: always
      prev: "*"
      next:
        - return
        - export

    - blankLine: never
      prev:
        - const
        - let
        - var
      next:
        - const
        - let
        - var




# -------------------------------------------------------------------------------------------------
overrides:
  - files:
    - "**/src/**/*.ts"
    - "**/src/**/*.tsx"

    parser: "@typescript-eslint/parser"

    extends:
      - plugin:@typescript-eslint/recommended

    plugins:
      - "@typescript-eslint"

    parserOptions:
      sourceType: "module"
      project: ./tsconfig.json

    rules:
      "@typescript-eslint/await-thenable": warn
      "@typescript-eslint/ban-ts-comment": off

      # $remark: https://eslint.org/docs/rules/indent#options
      # indent: off
      # "@typescript-eslint/indent":
      #   - error
      #   - 2
      #   - SwitchCase: 1
      #     MemberExpression: 0
      #     VariableDeclarator: "first"
      "@typescript-eslint/no-empty-interface": off
      "@typescript-eslint/no-empty-function":
        - off
        - allow: ["private-constructors"]
      "@typescript-eslint/no-explicit-any": off
      # $remark：https://eslint.org/docs/rules/indent#options
      "@typescript-eslint/no-unused-vars": off
      # "@typescript-eslint/no-useless-constructor": error

